---
output:
  html_document:
    code_folding: hide
    toc: true
    toc_depth: 6
    toc_float: true
    theme: lumen
pagetitle: Meteorite Final Project
---

###### [Home](http://bailey-jj.github.io/) \| [About Me](http://bailey-jj.github.io/about-me/) \| [CV](http://bailey-jj.github.io/CV/) \| [Portfolio](http://bailey-jj.github.io/portfolio/) \| [Contact](http://bailey-jj.github.io/contact/)

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Want to see my Shiny app?\
[Click here!](https://bailey-jj.shinyapps.io/Meteor_Map_App/){.uri}

### My Goal For This Project

My goal for this project was to learn how to map out data using leaflet. I also wanted to look into meteorite data, each meteorite has a class that it is given, and these classes are defined by their presumed origin. My main goal with this data set was to look at a meteorite's class and its mass. Certain meteorite's composition has an impact on how much of it is able to make it to Earth, and I wanted to look at that relationship. There is a lot of classifications and sub-classes for meteorites, so for the purpose of this project I will be looking at the main classes of meteorites.

```{r cleaning code, echo=TRUE, message=FALSE, warning=FALSE, collapse=TRUE}
options(scipen = 999)

library(tidyverse)
library(kableExtra)
library(shiny)
library(leaflet)
library(easystats)
library(patchwork)
library(janitor)
library(shinydashboard)
library(data.table)

meteors <- read_csv("./meteorites.csv")

# In the dataset, there is a correction needed to be made, Northwest Africa 7701, should say 2010, not 2101

meteors[meteors$name == "Northwest Africa 7701", 7] <- 2010
meteors[meteors$name == "Northwest Africa 7701", 7]

### Meteor Cleaning and Mapping ####
m_circles <- 
  meteors %>% 
  filter(!is.na(meteors$lat) & !is.na(meteors$long))
```

#### A Look into the Dataset

Here is a look into the data-set that I am looking into: This data-set comes from NASA's collection [insert link], but the downloaded csv file comes from Kaggle [insert link]. Note that there was a comment made for the data-set, the csv upon download has an type error; the meteorite, Northwest Africa 7701, should have a year value of 2010, not 2101, this is corrected for during the cleaning of the data-set.

```{r A look into the data-set, echo=FALSE, message=FALSE, warning=FALSE, collapse=TRUE}
#m_circles %>% 
  #kable %>%
  #kable_styling("striped", full_width = F) %>% 
  #scroll_box(width = "500px", height = "200px")
```

#### Summary of the Classes I Will be Analyzing

[Insert a brief summary into meteorite classes, and brief information]

Each meteorite class has varying masses, this is mostly based on their origins as well as their formation conditions. Their formation conditions and composition affects how much of the meteorite burns up in the atmosphere, and their relative masses. The most common meteorite fall under classes H and L.

```{r Meteorite Count, echo=TRUE, message=FALSE, warning=FALSE, collapse=TRUE}
m_circles %>% 
  ggplot(aes(x = class)) +
  geom_bar()
```

The graph above shows each meteorite class, and its count for found meteorites. 8 classes of meteorites are visually much greater in count than all other classes, the graph below shows those 8 classes and their counts.

```{r 8 most common meteorite count, echo=TRUE, message=FALSE, warning=FALSE, collapse=TRUE}
m_circles %>% 
  group_by(class) %>%
  count() %>% 
  filter(n > 900) %>% 
  ggplot(aes(x = class, y = n)) +
  geom_col(aes(fill = class))
```

When looking at the data I wanted to visualize count over the years. The graph below is just looking at counts per year.

```{r Meteor Count Over Time, echo=TRUE, message=FALSE, warning=FALSE, collapse=TRUE}
m_circles %>% 
  #dplyr::filter(fall == "Fell") %>% 
  #dplyr::filter(year > 1900) %>% 
  group_by(year) %>%
  count() %>% 
  ggplot(aes(x = year, y = n)) +
  geom_line()
```

The graph below looks at the same display as above but zoomed into the year 1900s to recent years.

```{r 1900s+ Graph, echo=TRUE, message=FALSE, warning=FALSE, collapse=TRUE}
m_circles %>% 
  #dplyr::filter(fall == "Fell") %>% 
  dplyr::filter(year > 1900) %>% 
  group_by(year) %>%
  count() %>% 
  ggplot(aes(x = year, y = n)) +
  geom_line()
```

When looking at the graph above initially, there seems to be a trend of more meteorites "falling" starting in the 1900s and beyond. To get a better look, the graph below displays a graph that is filtered and only shows meteorites labeled as "Fell", to get a visualization of the actual count of meteorites per year.

```{r 1900s+ Fell Graph, echo=TRUE, message=FALSE, warning=FALSE, collapse=TRUE}
m_circles %>% 
  dplyr::filter(fall == "Fell") %>% 
  dplyr::filter(year > 1900) %>% 
  group_by(year) %>%
  count() %>% 
  ggplot(aes(x = year, y = n)) +
  geom_line()
```

```{r exploring, message=FALSE, warning=FALSE, collapse=TRUE, include=FALSE}
### Exploring data ####
m_circles %>% 
  dplyr::filter(!is.na(year)) %>% 
  ggplot(aes(x = year, y = mass, color = name_type)) + 
  geom_point()

# This graph shows the expected results, that there are more meteors being found from 1700s to current day.

max(m_circles$year, na.rm = TRUE)
min(m_circles$year, na.rm = TRUE)

max(m_circles$mass, na.rm = TRUE)
min(m_circles$mass, na.rm = TRUE)

place_names <- 
  m_circles %>% 
  filter(!is.na(year)) %>% 
  mutate(name = trimws(str_remove(name, "(\\s+[A-Za-z]+)?[0-9-]+")))

unique(place_names$name)
```

### Discussion

Talk about learning to use leaflet and shiny, looking into meteorites, etc.

### Conclusion
